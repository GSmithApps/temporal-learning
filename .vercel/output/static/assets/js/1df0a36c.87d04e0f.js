"use strict";(self.webpackChunktemporal_learning=self.webpackChunktemporal_learning||[]).push([[1096],{3905:(e,t,a)=>{a.d(t,{Zo:()=>u,kt:()=>d});var o=a(7294);function n(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function i(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,o)}return a}function r(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?i(Object(a),!0).forEach((function(t){n(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):i(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function s(e,t){if(null==e)return{};var a,o,n=function(e,t){if(null==e)return{};var a,o,n={},i=Object.keys(e);for(o=0;o<i.length;o++)a=i[o],t.indexOf(a)>=0||(n[a]=e[a]);return n}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(o=0;o<i.length;o++)a=i[o],t.indexOf(a)>=0||Object.prototype.propertyIsEnumerable.call(e,a)&&(n[a]=e[a])}return n}var l=o.createContext({}),c=function(e){var t=o.useContext(l),a=t;return e&&(a="function"==typeof e?e(t):r(r({},t),e)),a},u=function(e){var t=c(e.components);return o.createElement(l.Provider,{value:t},e.children)},h={inlineCode:"code",wrapper:function(e){var t=e.children;return o.createElement(o.Fragment,{},t)}},p=o.forwardRef((function(e,t){var a=e.components,n=e.mdxType,i=e.originalType,l=e.parentName,u=s(e,["components","mdxType","originalType","parentName"]),p=c(a),d=n,f=p["".concat(l,".").concat(d)]||p[d]||h[d]||i;return a?o.createElement(f,r(r({ref:t},u),{},{components:a})):o.createElement(f,r({ref:t},u))}));function d(e,t){var a=arguments,n=t&&t.mdxType;if("string"==typeof e||n){var i=a.length,r=new Array(i);r[0]=p;var s={};for(var l in t)hasOwnProperty.call(t,l)&&(s[l]=t[l]);s.originalType=e,s.mdxType="string"==typeof e?e:n,r[1]=s;for(var c=2;c<i;c++)r[c]=a[c];return o.createElement.apply(null,r)}return o.createElement.apply(null,a)}p.displayName="MDXCreateElement"},5162:(e,t,a)=>{a.d(t,{Z:()=>r});var o=a(7294),n=a(4334);const i="tabItem_Ymn6";function r(e){let{children:t,hidden:a,className:r}=e;return o.createElement("div",{role:"tabpanel",className:(0,n.Z)(i,r),hidden:a},t)}},4866:(e,t,a)=>{a.d(t,{Z:()=>x});var o=a(3117),n=a(7294),i=a(4334),r=a(6775),s=a(1980),l=a(7392),c=a(12);function u(e){return function(e){return n.Children.map(e,(e=>{if(!e||(0,n.isValidElement)(e)&&function(e){const{props:t}=e;return!!t&&"object"==typeof t&&"value"in t}(e))return e;throw new Error(`Docusaurus error: Bad <Tabs> child <${"string"==typeof e.type?e.type:e.type.name}>: all children of the <Tabs> component should be <TabItem>, and every <TabItem> should have a unique "value" prop.`)}))?.filter(Boolean)??[]}(e).map((e=>{let{props:{value:t,label:a,attributes:o,default:n}}=e;return{value:t,label:a,attributes:o,default:n}}))}function h(e){const{values:t,children:a}=e;return(0,n.useMemo)((()=>{const e=t??u(a);return function(e){const t=(0,l.l)(e,((e,t)=>e.value===t.value));if(t.length>0)throw new Error(`Docusaurus error: Duplicate values "${t.map((e=>e.value)).join(", ")}" found in <Tabs>. Every value needs to be unique.`)}(e),e}),[t,a])}function p(e){let{value:t,tabValues:a}=e;return a.some((e=>e.value===t))}function d(e){let{queryString:t=!1,groupId:a}=e;const o=(0,r.k6)(),i=function(e){let{queryString:t=!1,groupId:a}=e;if("string"==typeof t)return t;if(!1===t)return null;if(!0===t&&!a)throw new Error('Docusaurus error: The <Tabs> component groupId prop is required if queryString=true, because this value is used as the search param name. You can also provide an explicit value such as queryString="my-search-param".');return a??null}({queryString:t,groupId:a});return[(0,s._X)(i),(0,n.useCallback)((e=>{if(!i)return;const t=new URLSearchParams(o.location.search);t.set(i,e),o.replace({...o.location,search:t.toString()})}),[i,o])]}function f(e){const{defaultValue:t,queryString:a=!1,groupId:o}=e,i=h(e),[r,s]=(0,n.useState)((()=>function(e){let{defaultValue:t,tabValues:a}=e;if(0===a.length)throw new Error("Docusaurus error: the <Tabs> component requires at least one <TabItem> children component");if(t){if(!p({value:t,tabValues:a}))throw new Error(`Docusaurus error: The <Tabs> has a defaultValue "${t}" but none of its children has the corresponding value. Available values are: ${a.map((e=>e.value)).join(", ")}. If you intend to show no default tab, use defaultValue={null} instead.`);return t}const o=a.find((e=>e.default))??a[0];if(!o)throw new Error("Unexpected error: 0 tabValues");return o.value}({defaultValue:t,tabValues:i}))),[l,u]=d({queryString:a,groupId:o}),[f,m]=function(e){let{groupId:t}=e;const a=function(e){return e?`docusaurus.tab.${e}`:null}(t),[o,i]=(0,c.Nk)(a);return[o,(0,n.useCallback)((e=>{a&&i.set(e)}),[a,i])]}({groupId:o}),k=(()=>{const e=l??f;return p({value:e,tabValues:i})?e:null})();(0,n.useLayoutEffect)((()=>{k&&s(k)}),[k]);return{selectedValue:r,selectValue:(0,n.useCallback)((e=>{if(!p({value:e,tabValues:i}))throw new Error(`Can't select invalid tab value=${e}`);s(e),u(e),m(e)}),[u,m,i]),tabValues:i}}var m=a(2466),k=a(2389);const g="tabList__CuJ",y="tabItem_LNqP";function w(e){let{className:t,block:a,selectedValue:r,selectValue:s,tabValues:l}=e;const c=[],{blockElementScrollPositionUntilNextRender:u}=(0,m.o5)(),h=e=>{const t=e.currentTarget,a=c.indexOf(t),o=l[a].value;o!==r&&(u(t),s(o))},p=e=>{let t=null;switch(e.key){case"Enter":h(e);break;case"ArrowRight":{const a=c.indexOf(e.currentTarget)+1;t=c[a]??c[0];break}case"ArrowLeft":{const a=c.indexOf(e.currentTarget)-1;t=c[a]??c[c.length-1];break}}t?.focus()};return n.createElement("ul",{role:"tablist","aria-orientation":"horizontal",className:(0,i.Z)("tabs",{"tabs--block":a},t)},l.map((e=>{let{value:t,label:a,attributes:s}=e;return n.createElement("li",(0,o.Z)({role:"tab",tabIndex:r===t?0:-1,"aria-selected":r===t,key:t,ref:e=>c.push(e),onKeyDown:p,onClick:h},s,{className:(0,i.Z)("tabs__item",y,s?.className,{"tabs__item--active":r===t})}),a??t)})))}function b(e){let{lazy:t,children:a,selectedValue:o}=e;const i=(Array.isArray(a)?a:[a]).filter(Boolean);if(t){const e=i.find((e=>e.props.value===o));return e?(0,n.cloneElement)(e,{className:"margin-top--md"}):null}return n.createElement("div",{className:"margin-top--md"},i.map(((e,t)=>(0,n.cloneElement)(e,{key:t,hidden:e.props.value!==o}))))}function v(e){const t=f(e);return n.createElement("div",{className:(0,i.Z)("tabs-container",g)},n.createElement(w,(0,o.Z)({},e,t)),n.createElement(b,(0,o.Z)({},e,t)))}function x(e){const t=(0,k.Z)();return n.createElement(v,(0,o.Z)({key:String(t)},e))}},1053:(e,t,a)=>{a.r(t),a.d(t,{assets:()=>l,contentTitle:()=>r,default:()=>h,frontMatter:()=>i,metadata:()=>s,toc:()=>c});var o=a(3117),n=(a(7294),a(3905));a(5162),a(4866);const i={id:"application-design",sidebar_position:4,keywords:["go","golang","temporal","sdk","tutorial"],title:"How to design and implement the Background Check application",description:"Start by mapping business process to Workflows.",tags:["Go","SDK"],image:"/img/temporal-logo-twitter-card.png"},r=void 0,s={unversionedId:"examples/go/background-checks/application-design",id:"examples/go/background-checks/application-design",title:"How to design and implement the Background Check application",description:"Start by mapping business process to Workflows.",source:"@site/docs/examples/go/background-checks/application-design-and-implementation.md",sourceDirName:"examples/go/background-checks",slug:"/examples/go/background-checks/application-design",permalink:"/examples/go/background-checks/application-design",draft:!1,tags:[{label:"Go",permalink:"/tags/go"},{label:"SDK",permalink:"/tags/sdk"}],version:"current",lastUpdatedAt:1714488451,formattedLastUpdatedAt:"Apr 30, 2024",sidebarPosition:4,frontMatter:{id:"application-design",sidebar_position:4,keywords:["go","golang","temporal","sdk","tutorial"],title:"How to design and implement the Background Check application",description:"Start by mapping business process to Workflows.",tags:["Go","SDK"],image:"/img/temporal-logo-twitter-card.png"},sidebar:"tutorialSidebar",previous:{title:"What are the requirements of the Background Check application?",permalink:"/examples/go/background-checks/application-requirements"},next:{title:"What does the main Background Check Workflow Definition look like?",permalink:"/examples/go/background-checks/main-background-check"}},l={},c=[{value:"What business processes are map to Workflows?",id:"what-business-processes-are-map-to-workflows",level:2},{value:"Why use Child Workflows for Searches instead of Activities?",id:"why-use-child-workflows-for-searches-instead-of-activities",level:2},{value:"Which steps within a business process map to Activities?",id:"which-steps-within-a-business-process-map-to-activities",level:2},{value:"What happens if an Activity Execution fails?",id:"what-happens-if-an-activity-execution-fails",level:2},{value:"What happens if an individual Search fails?",id:"what-happens-if-an-individual-search-fails",level:2},{value:"Do you need a database?",id:"do-you-need-a-database",level:2},{value:"What does the component topology look like?",id:"what-does-the-component-topology-look-like",level:2},{value:"How do you ensure PII is encrypted in the Temporal Platform?",id:"how-do-you-ensure-pii-is-encrypted-in-the-temporal-platform",level:2},{value:"How do you know what the status of a Background Check is",id:"how-do-you-know-what-the-status-of-a-background-check-is",level:2},{value:"How do you know what the state of a Background Check is?",id:"how-do-you-know-what-the-state-of-a-background-check-is",level:2},{value:"How do you get data into a running Workflow Execution?",id:"how-do-you-get-data-into-a-running-workflow-execution",level:2},{value:"How do you handle a Cancellation Request of a business process?",id:"how-do-you-handle-a-cancellation-request-of-a-business-process",level:2}],u={toc:c};function h(e){let{components:t,...i}=e;return(0,n.kt)("wrapper",(0,o.Z)({},u,i,{components:t,mdxType:"MDXLayout"}),(0,n.kt)("h2",{id:"what-business-processes-are-map-to-workflows"},"What business processes are map to Workflows?"),(0,n.kt)("p",null,"The application maps each of the following business processes to its own Workflow Definition:"),(0,n.kt)("ul",null,(0,n.kt)("li",{parentName:"ul"},(0,n.kt)("a",{parentName:"li",href:"/examples/go/background-checks/main-background-check"},"Main Background Check")),(0,n.kt)("li",{parentName:"ul"},(0,n.kt)("a",{parentName:"li",href:"/examples/go/background-checks/candidate-acceptance"},"Candidate Acceptance")),(0,n.kt)("li",{parentName:"ul"},(0,n.kt)("a",{parentName:"li",href:"/examples/go/background-checks/ssn-trace"},"SSN Trace")),(0,n.kt)("li",{parentName:"ul"},(0,n.kt)("a",{parentName:"li",href:"/examples/go/background-checks/federal-criminal-search"},"Federal Criminal Search")),(0,n.kt)("li",{parentName:"ul"},(0,n.kt)("a",{parentName:"li",href:"/examples/go/background-checks/state-criminal-search"},"State Criminal Search")),(0,n.kt)("li",{parentName:"ul"},(0,n.kt)("a",{parentName:"li",href:"/examples/go/background-checks/motor-vehicle-search"},"Motor Vehicle Search")),(0,n.kt)("li",{parentName:"ul"},(0,n.kt)("a",{parentName:"li",href:"/examples/go/background-checks/employment-verification"},"Employment Verification"))),(0,n.kt)("h2",{id:"why-use-child-workflows-for-searches-instead-of-activities"},"Why use Child Workflows for Searches instead of Activities?"),(0,n.kt)("p",null,"This application uses Child Workflows for Searches for a few reasons."),(0,n.kt)("ol",null,(0,n.kt)("li",{parentName:"ol"},"Each Search could be long running: In a real-life scenario, you won't know how long a Search might take to return a result.\nIndividual Searches and Background Checks overall can often take hours or days to complete.\nAlthough Temporal supports long running Activities, an actual Search is conducted by a third-party system, so Heartbeats are not very helpful here.\nAn Activity does make the call to the third-party system, but you can set a Timeout on the Activity Execution and let the Workflow Execution be the long running process."),(0,n.kt)("li",{parentName:"ol"},"Division of responsibilities: In a real-life scenario, you might have a team that is dedicated to a particular Search.\nThe Background Check team manages their Workflow Definition, while the Federal Criminal Search team manages its own Workflow Definition, for example, to create a sort of inter-team distributed system that can work together to accomplish goals.\nThis makes it easier when it comes to delegating responsibilities around bug fixes and CI/CD pipelines."),(0,n.kt)("li",{parentName:"ol"},"The state of a Workflow is maintained: The results of an Activity are written to the Workflow Execution Event History.\nInstead of writing Search results directly to the Background Check Workflow Execution, keep them separate in their own Workflow Execution and access them independently from the Background Check Workflow."),(0,n.kt)("li",{parentName:"ol"},"Reduces the need to version the main Background Check Workflow: Workflow Execution Event Histories are separated.")),(0,n.kt)("h2",{id:"which-steps-within-a-business-process-map-to-activities"},"Which steps within a business process map to Activities?"),(0,n.kt)("p",null,"This application uses Activities for the following business sub-processes:"),(0,n.kt)("ul",null,(0,n.kt)("li",{parentName:"ul"},"Sending email"),(0,n.kt)("li",{parentName:"ul"},"Calling third-party APIs")),(0,n.kt)("p",null,"Sending an email message and calling third party APIs are considered unreliable steps in the business process."),(0,n.kt)("h2",{id:"what-happens-if-an-activity-execution-fails"},"What happens if an Activity Execution fails?"),(0,n.kt)("p",null,"Activities are meant to handle the unreliable steps of the business process.\nTo simulate unreliability, the sample adds middleware that produces about a 40% rate of failure on the third party API calls.\nThis sample configures similar functionality with the Mailhog instance that causes random SMTP failures."),(0,n.kt)("p",null,"Activities each use a default Retry Policy.\nSo when an Activity Task Execution fails the Temporal Cluster will try to execute the code again.\nThe sample sets a Schedule-To-Close Timeout of 1 minute for each Activity Execution that limits that overall execution time.\nYou won't ever wait longer than 1 minute for any given Activity Execution to complete.\nUsing a Schedule-To-Close Timeout to limit the overall execution time is often a better solution that using the Maximum Attempts setting on the Retry Policy, as it provides a clear time cutoff for real life use cases."),(0,n.kt)("p",null,"If an Activity Execution does fail, it returns the error from the latest attempt to the Workflow Execution that spawned it.\nThe Workflow then decides how to handle the fact that the Activity Execution failed."),(0,n.kt)("h2",{id:"what-happens-if-an-individual-search-fails"},"What happens if an individual Search fails?"),(0,n.kt)("p",null,"For demonstration purposes, if an Activity Execution does fail, the Workflow Execution (Or Child Workflow Execution) that spawned it returns the error that was returned from the Activity Execution, and the Workflow Execution closes with a Failed status"),(0,n.kt)("p",null,"Should an individual Search fail, the Background Check still returns as much of the report as it can.\nThe error that caused a Search to fail is included in the report.\nThe one exception to this is if the SSN Trace Child Workflow Execution fails, as the addresses that are returned from that Search are required to conduct the remaining Searches."),(0,n.kt)("p",null,"If an individual Search fails, then the Company HR Person can choose to run another Background Check if they want."),(0,n.kt)("h2",{id:"do-you-need-a-database"},"Do you need a database?"),(0,n.kt)("p",null,"No, you will not need a database for this application.\nAll of the application state is maintained by the Temporal Cluster."),(0,n.kt)("p",null,"While a Workflow Execution is Running, its Event History (state) is perpetually maintained.\nWhen a Workflow Execution reaches a Closed status, the Temporal Cluster persists its Event History per the retention period."),(0,n.kt)("p",null,"In a real-life scenario, to persist the Event History of the Background Check longer than the Temporal Cluster retention period, you would have an additional business process Workflow to store Background Checks in a database, and an additional business process Workflow to retrieve them.\nBecause the default retention period for a Temporal Cluster is 7 days, this application will not support that."),(0,n.kt)("h2",{id:"what-does-the-component-topology-look-like"},"What does the component topology look like?"),(0,n.kt)("p",null,(0,n.kt)("img",{alt:"Diagram of component topology of the Temporal Application",src:a(4518).Z,width:"840",height:"1500"})),(0,n.kt)("p",null,"The Temporal Client communicates with the Temporal Cluster (Temporal Server + Database)."),(0,n.kt)("p",null,"The Temporal Cluster communicates with the Workers that execute the application code.\nThe application has one Worker Process and one Worker Entity."),(0,n.kt)("p",null,"However, in real life,the application could use as many Worker Processes (each with multiple Worker Entities) as needed."),(0,n.kt)("h2",{id:"how-do-you-ensure-pii-is-encrypted-in-the-temporal-platform"},"How do you ensure PII is encrypted in the Temporal Platform?"),(0,n.kt)("p",null,"To ensure data is encrypted while in the Temporal Platform, you use a customized ",(0,n.kt)("a",{parentName:"p",href:"https://docs.temporal.io/security/#custom-data-converter"},"Data Converter"),"."),(0,n.kt)("h2",{id:"how-do-you-know-what-the-status-of-a-background-check-is"},"How do you know what the status of a Background Check is"),(0,n.kt)("p",null,"The status refers to the whether a Background Check is Open or Closed."),(0,n.kt)("p",null,"You can use the Temporal Platform's ",(0,n.kt)("a",{parentName:"p",href:"https://docs.temporal.io/visibility/#advanced-visibility"},"Visibility APIs")," to see the status of any oftheWorkflow Executions.\nIn this application you wrapped the ",(0,n.kt)("inlineCode",{parentName:"p"},"bgc-company list")," command around these Visibility APIs.\nYou also make sure to add custom Search Attributes totheBackground Check Workflows.\nWhen you run ",(0,n.kt)("inlineCode",{parentName:"p"},"bgc-company list")," you are using the Visibility APIs and passing a ",(0,n.kt)("a",{parentName:"p",href:"https://docs.temporal.io/visibility/#list-filter"},"List Filter")," that gives us back only the Background Check Workflow Executions."),(0,n.kt)("h2",{id:"how-do-you-know-what-the-state-of-a-background-check-is"},"How do you know what the state of a Background Check is?"),(0,n.kt)("p",null,'Not the same as "status", state refers to the values of variables in the Background Check Workflow Execution.\nYou can know the state by sending a Query to a Background Check.\nThe Background Check is developed to listen for a Query and provide data in response.\nThe Background Check actually provides the same object in response to a Query as it does when the function returns.\nTemporal automatically provides the result of the function if the Workflow Execution is in a closed state when the Query is processed by the Temporal Cluster.'),(0,n.kt)("p",null,"This means that you can use a Query to get the state of a Background Check at any time.\nYou can see this implemented in the ",(0,n.kt)("a",{parentName:"p",href:"/examples/go/background-checks/main-background-check"},"Background Check Workflow Definition")," where the Query Handler is set."),(0,n.kt)("p",null,"You also use a Query to get the details of the Candidate from the Employer Verification Workflow Execution when the Researcher uses the Web UI to load and verify the Candidate information."),(0,n.kt)("h2",{id:"how-do-you-get-data-into-a-running-workflow-execution"},"How do you get data into a running Workflow Execution?"),(0,n.kt)("p",null,"You use Signals to get data into a running Workflow Execution."),(0,n.kt)("h2",{id:"how-do-you-handle-a-cancellation-request-of-a-business-process"},"How do you handle a Cancellation Request of a business process?"),(0,n.kt)("p",null,'Within a Workflow Definition, you have logic to explicitly handle a Cancellation Request, so you can "clean up" anything you need to prior to cancelling.'))}h.isMDXComponent=!0},4518:(e,t,a)=>{a.d(t,{Z:()=>o});const o=a.p+"assets/images/component-topology-c5af6c51e01dfe54fdd2fdb0238022cc.svg"}}]);