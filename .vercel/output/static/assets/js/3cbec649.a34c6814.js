"use strict";(self.webpackChunktemporal_learning=self.webpackChunktemporal_learning||[]).push([[95],{3905:(e,t,a)=>{a.d(t,{Zo:()=>u,kt:()=>d});var r=a(7294);function n(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function o(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,r)}return a}function l(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?o(Object(a),!0).forEach((function(t){n(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):o(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function i(e,t){if(null==e)return{};var a,r,n=function(e,t){if(null==e)return{};var a,r,n={},o=Object.keys(e);for(r=0;r<o.length;r++)a=o[r],t.indexOf(a)>=0||(n[a]=e[a]);return n}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(r=0;r<o.length;r++)a=o[r],t.indexOf(a)>=0||Object.prototype.propertyIsEnumerable.call(e,a)&&(n[a]=e[a])}return n}var s=r.createContext({}),p=function(e){var t=r.useContext(s),a=t;return e&&(a="function"==typeof e?e(t):l(l({},t),e)),a},u=function(e){var t=p(e.components);return r.createElement(s.Provider,{value:t},e.children)},c={inlineCode:"code",wrapper:function(e){var t=e.children;return r.createElement(r.Fragment,{},t)}},m=r.forwardRef((function(e,t){var a=e.components,n=e.mdxType,o=e.originalType,s=e.parentName,u=i(e,["components","mdxType","originalType","parentName"]),m=p(a),d=n,f=m["".concat(s,".").concat(d)]||m[d]||c[d]||o;return a?r.createElement(f,l(l({ref:t},u),{},{components:a})):r.createElement(f,l({ref:t},u))}));function d(e,t){var a=arguments,n=t&&t.mdxType;if("string"==typeof e||n){var o=a.length,l=new Array(o);l[0]=m;var i={};for(var s in t)hasOwnProperty.call(t,s)&&(i[s]=t[s]);i.originalType=e,i.mdxType="string"==typeof e?e:n,l[1]=i;for(var p=2;p<o;p++)l[p]=a[p];return r.createElement.apply(null,l)}return r.createElement.apply(null,a)}m.displayName="MDXCreateElement"},5162:(e,t,a)=>{a.d(t,{Z:()=>l});var r=a(7294),n=a(4334);const o="tabItem_Ymn6";function l(e){let{children:t,hidden:a,className:l}=e;return r.createElement("div",{role:"tabpanel",className:(0,n.Z)(o,l),hidden:a},t)}},4866:(e,t,a)=>{a.d(t,{Z:()=>C});var r=a(3117),n=a(7294),o=a(4334),l=a(6775),i=a(1980),s=a(7392),p=a(12);function u(e){return function(e){return n.Children.map(e,(e=>{if(!e||(0,n.isValidElement)(e)&&function(e){const{props:t}=e;return!!t&&"object"==typeof t&&"value"in t}(e))return e;throw new Error(`Docusaurus error: Bad <Tabs> child <${"string"==typeof e.type?e.type:e.type.name}>: all children of the <Tabs> component should be <TabItem>, and every <TabItem> should have a unique "value" prop.`)}))?.filter(Boolean)??[]}(e).map((e=>{let{props:{value:t,label:a,attributes:r,default:n}}=e;return{value:t,label:a,attributes:r,default:n}}))}function c(e){const{values:t,children:a}=e;return(0,n.useMemo)((()=>{const e=t??u(a);return function(e){const t=(0,s.l)(e,((e,t)=>e.value===t.value));if(t.length>0)throw new Error(`Docusaurus error: Duplicate values "${t.map((e=>e.value)).join(", ")}" found in <Tabs>. Every value needs to be unique.`)}(e),e}),[t,a])}function m(e){let{value:t,tabValues:a}=e;return a.some((e=>e.value===t))}function d(e){let{queryString:t=!1,groupId:a}=e;const r=(0,l.k6)(),o=function(e){let{queryString:t=!1,groupId:a}=e;if("string"==typeof t)return t;if(!1===t)return null;if(!0===t&&!a)throw new Error('Docusaurus error: The <Tabs> component groupId prop is required if queryString=true, because this value is used as the search param name. You can also provide an explicit value such as queryString="my-search-param".');return a??null}({queryString:t,groupId:a});return[(0,i._X)(o),(0,n.useCallback)((e=>{if(!o)return;const t=new URLSearchParams(r.location.search);t.set(o,e),r.replace({...r.location,search:t.toString()})}),[o,r])]}function f(e){const{defaultValue:t,queryString:a=!1,groupId:r}=e,o=c(e),[l,i]=(0,n.useState)((()=>function(e){let{defaultValue:t,tabValues:a}=e;if(0===a.length)throw new Error("Docusaurus error: the <Tabs> component requires at least one <TabItem> children component");if(t){if(!m({value:t,tabValues:a}))throw new Error(`Docusaurus error: The <Tabs> has a defaultValue "${t}" but none of its children has the corresponding value. Available values are: ${a.map((e=>e.value)).join(", ")}. If you intend to show no default tab, use defaultValue={null} instead.`);return t}const r=a.find((e=>e.default))??a[0];if(!r)throw new Error("Unexpected error: 0 tabValues");return r.value}({defaultValue:t,tabValues:o}))),[s,u]=d({queryString:a,groupId:r}),[f,h]=function(e){let{groupId:t}=e;const a=function(e){return e?`docusaurus.tab.${e}`:null}(t),[r,o]=(0,p.Nk)(a);return[r,(0,n.useCallback)((e=>{a&&o.set(e)}),[a,o])]}({groupId:r}),k=(()=>{const e=s??f;return m({value:e,tabValues:o})?e:null})();(0,n.useLayoutEffect)((()=>{k&&i(k)}),[k]);return{selectedValue:l,selectValue:(0,n.useCallback)((e=>{if(!m({value:e,tabValues:o}))throw new Error(`Can't select invalid tab value=${e}`);i(e),u(e),h(e)}),[u,h,o]),tabValues:o}}var h=a(2466),k=a(2389);const g="tabList__CuJ",y="tabItem_LNqP";function v(e){let{className:t,block:a,selectedValue:l,selectValue:i,tabValues:s}=e;const p=[],{blockElementScrollPositionUntilNextRender:u}=(0,h.o5)(),c=e=>{const t=e.currentTarget,a=p.indexOf(t),r=s[a].value;r!==l&&(u(t),i(r))},m=e=>{let t=null;switch(e.key){case"Enter":c(e);break;case"ArrowRight":{const a=p.indexOf(e.currentTarget)+1;t=p[a]??p[0];break}case"ArrowLeft":{const a=p.indexOf(e.currentTarget)-1;t=p[a]??p[p.length-1];break}}t?.focus()};return n.createElement("ul",{role:"tablist","aria-orientation":"horizontal",className:(0,o.Z)("tabs",{"tabs--block":a},t)},s.map((e=>{let{value:t,label:a,attributes:i}=e;return n.createElement("li",(0,r.Z)({role:"tab",tabIndex:l===t?0:-1,"aria-selected":l===t,key:t,ref:e=>p.push(e),onKeyDown:m,onClick:c},i,{className:(0,o.Z)("tabs__item",y,i?.className,{"tabs__item--active":l===t})}),a??t)})))}function T(e){let{lazy:t,children:a,selectedValue:r}=e;const o=(Array.isArray(a)?a:[a]).filter(Boolean);if(t){const e=o.find((e=>e.props.value===r));return e?(0,n.cloneElement)(e,{className:"margin-top--md"}):null}return n.createElement("div",{className:"margin-top--md"},o.map(((e,t)=>(0,n.cloneElement)(e,{key:t,hidden:e.props.value!==r}))))}function N(e){const t=f(e);return n.createElement("div",{className:(0,o.Z)("tabs-container",g)},n.createElement(v,(0,r.Z)({},e,t)),n.createElement(T,(0,r.Z)({},e,t)))}function C(e){const t=(0,k.Z)();return n.createElement(N,(0,r.Z)({key:String(t)},e))}},4073:(e,t,a)=>{a.r(t),a.d(t,{assets:()=>u,contentTitle:()=>s,default:()=>d,frontMatter:()=>i,metadata:()=>p,toc:()=>c});var r=a(3117),n=(a(7294),a(3905)),o=a(4866),l=a(5162);const i={title:"Run Workers with Temporal Cloud for the Java SDK",id:"run-workers-with-cloud-java",sidebar_position:4,description:"In this tutorial, you'll learn how to migrate your Java application from a local Temporal Server to a managed Temporal Cloud environment, leveraging the benefits of a scalable and reliable platform for running your Workflows and Activities.",keywords:["java","temporal","sdk","tutorial","example","workflow","worker","getting started","temporal cloud","managed service","migrating"],tags:["Java","SDK","Temporal Cloud"],last_update:{date:new Date("2024-01-22T00:00:00.000Z")},code_repo:"https://github.com/temporalio/money-transfer-project-template-java",image:"/img/temporal-logo-twitter-card.png"},s=void 0,p={unversionedId:"getting_started/java/run_workers_with_cloud_java/run-workers-with-cloud-java",id:"getting_started/java/run_workers_with_cloud_java/run-workers-with-cloud-java",title:"Run Workers with Temporal Cloud for the Java SDK",description:"In this tutorial, you'll learn how to migrate your Java application from a local Temporal Server to a managed Temporal Cloud environment, leveraging the benefits of a scalable and reliable platform for running your Workflows and Activities.",source:"@site/docs/getting_started/java/run_workers_with_cloud_java/index.md",sourceDirName:"getting_started/java/run_workers_with_cloud_java",slug:"/getting_started/java/run_workers_with_cloud_java/",permalink:"/getting_started/java/run_workers_with_cloud_java/",draft:!1,tags:[{label:"Java",permalink:"/tags/java"},{label:"SDK",permalink:"/tags/sdk"},{label:"Temporal Cloud",permalink:"/tags/temporal-cloud"}],version:"current",lastUpdatedAt:1705881600,formattedLastUpdatedAt:"Jan 22, 2024",sidebarPosition:4,frontMatter:{title:"Run Workers with Temporal Cloud for the Java SDK",id:"run-workers-with-cloud-java",sidebar_position:4,description:"In this tutorial, you'll learn how to migrate your Java application from a local Temporal Server to a managed Temporal Cloud environment, leveraging the benefits of a scalable and reliable platform for running your Workflows and Activities.",keywords:["java","temporal","sdk","tutorial","example","workflow","worker","getting started","temporal cloud","managed service","migrating"],tags:["Java","SDK","Temporal Cloud"],last_update:{date:"2024-01-22T00:00:00.000Z"},code_repo:"https://github.com/temporalio/money-transfer-project-template-java",image:"/img/temporal-logo-twitter-card.png"},sidebar:"tutorialSidebar",previous:{title:"Build a Temporal Application from scratch in Java",permalink:"/getting_started/java/hello_world_in_java/"},next:{title:"TypeScript",permalink:"/getting_started/typescript/"}},u={},c=[{value:"Prerequisites",id:"prerequisites",level:3},{value:"Generate certificates",id:"generate-certificates",level:2},{value:"Update Worker code to connect to Temporal Cloud",id:"update-worker-code-to-connect-to-temporal-cloud",level:2},{value:"Set the required environment variables",id:"set-the-required-environment-variables",level:2},{value:"Run your application connected to Temporal Cloud",id:"run-your-application-connected-to-temporal-cloud",level:2},{value:"Conclusion",id:"conclusion",level:2}],m={toc:c};function d(e){let{components:t,...i}=e;return(0,n.kt)("wrapper",(0,r.Z)({},m,i,{components:t,mdxType:"MDXLayout"}),(0,n.kt)("p",null,"Temporal Cloud oversees the execution process by preserving the source of truth for your Workflow Execution Event Histories.\nThis independent supervision ensures the durable execution of your distributed applications and services."),(0,n.kt)("p",null,"In ",(0,n.kt)("a",{parentName:"p",href:"/getting_started/java/first_program_in_java"},"Run your first Temporal application with the Java SDK"),", you started a Worker and ran a Workflow with a local instance of the Temporal Service."),(0,n.kt)("p",null,"While this setup is suitable for local development and testing, it may not be ideal for production workloads that require scalability and high availability."),(0,n.kt)("p",null,"In this tutorial, you will migrate your application from a local Temporal Server to a managed Temporal Cloud environment, generate certificates, update your Worker code, and run your Workflow."),(0,n.kt)("h3",{id:"prerequisites"},"Prerequisites"),(0,n.kt)("p",null,"Before getting started, review the following prerequisites:"),(0,n.kt)("ul",null,(0,n.kt)("li",{parentName:"ul"},"Get access to a ",(0,n.kt)("a",{parentName:"li",href:"https://docs.temporal.io/cloud/get-started"},"Temporal Cloud account"),"."),(0,n.kt)("li",{parentName:"ul"},"Complete the ",(0,n.kt)("a",{parentName:"li",href:"/getting_started/java/first_program_in_java/"},"Run your first Temporal application with the Java SDK")," tutorial."),(0,n.kt)("li",{parentName:"ul"},"Provide a method to generate certificates for your Namespace.")),(0,n.kt)("h2",{id:"generate-certificates"},"Generate certificates"),(0,n.kt)("p",null,"Certificates are crucial for securing access and communication with Temporal Cloud.\nThey are required for configuring mutual Transport Layer Security (mTLS) protocol, which is used to secure Temporal Cloud access."),(0,n.kt)("p",null,"You have a few options to generate certificates."),(0,n.kt)("ul",null,(0,n.kt)("li",{parentName:"ul"},"Use existing certificate management infrastructure to generate certificates for your Namespace."),(0,n.kt)("li",{parentName:"ul"},"Use Temporal's built-in certificate generation tool ",(0,n.kt)("a",{parentName:"li",href:"https://docs.temporal.io/cloud/tcld"},"tcld"),"."),(0,n.kt)("li",{parentName:"ul"},"Use open-source tools like ",(0,n.kt)("a",{parentName:"li",href:"https://github.com/square/certstrap"},"certstrap"),".")),(0,n.kt)("p",null,"The next step uses ",(0,n.kt)("a",{parentName:"p",href:"https://github.com/square/certstrap"},"certstrap")," to generate certificates."),(0,n.kt)("p",null,(0,n.kt)("strong",{parentName:"p"},"Create a Certificate Authority (CA)")),(0,n.kt)("p",null,"Create a new Certificate Authority (CA) using Certstrap:"),(0,n.kt)("pre",null,(0,n.kt)("code",{parentName:"pre",className:"language-command"},'./certstrap init --common-name "Cert"\n')),(0,n.kt)("p",null,"This command creates a self-signed CA certificate named ",(0,n.kt)("inlineCode",{parentName:"p"},"Cert.crt")," in the ",(0,n.kt)("inlineCode",{parentName:"p"},"out")," folder within the Certstrap directory.\nThis CA certificate will be used to sign and issue end-entity certificates."),(0,n.kt)("p",null,(0,n.kt)("strong",{parentName:"p"},"Set the Namespace Name")),(0,n.kt)("p",null,"Set the Namespace Name as the common name for the end-entity certificate:"),(0,n.kt)(o.Z,{mdxType:"Tabs"},(0,n.kt)(l.Z,{value:"macos",label:"macOs",default:!0,mdxType:"TabItem"},(0,n.kt)("p",null,"For Linux or macOS:"),(0,n.kt)("pre",null,(0,n.kt)("code",{parentName:"pre",className:"language-command"},"export NAMESPACE_NAME=your-namespace\n"))),(0,n.kt)(l.Z,{value:"windows",label:"Windows",default:!0,mdxType:"TabItem"},(0,n.kt)("p",null,"For Windows:"),(0,n.kt)("pre",null,(0,n.kt)("code",{parentName:"pre",className:"language-command"},"set NAMESPACE_NAME=your-namespace\n")))),(0,n.kt)("p",null,"Replace ",(0,n.kt)("inlineCode",{parentName:"p"},"your-namespace")," with the name of your Temporal Cloud namespace."),(0,n.kt)("p",null,(0,n.kt)("strong",{parentName:"p"},"Request an End-Entity Certificate")),(0,n.kt)("p",null,"Next, request a certificate with a common name equal to the Namespace Name:"),(0,n.kt)("pre",null,(0,n.kt)("code",{parentName:"pre",className:"language-command"},"./certstrap request-cert --common-name ${NAMESPACE_NAME}\n")),(0,n.kt)("p",null,"This command creates a Certificate Signing Request (CSR) for an end-entity certificate, but not the actual certificate itself."),(0,n.kt)("p",null,(0,n.kt)("strong",{parentName:"p"},"Sign the Certificate Request")),(0,n.kt)("p",null,"Sign the certificate request and generate the end-entity certificate:"),(0,n.kt)("pre",null,(0,n.kt)("code",{parentName:"pre",className:"language-command"},'./certstrap sign ${NAMESPACE_NAME} --CA "Cert"\n')),(0,n.kt)("p",null,"This command takes the CSR from the previous step and signs it with your CA (",(0,n.kt)("inlineCode",{parentName:"p"},"Cert"),").\nThe result is an end-entity certificate (",(0,n.kt)("inlineCode",{parentName:"p"},"your-namespace.crt"),") that is now a valid certificate signed by your CA."),(0,n.kt)("p",null,(0,n.kt)("strong",{parentName:"p"},"(optional) Convert to PKCS8 Format for Java SDK")),(0,n.kt)("p",null,"If you are using the Temporal Java SDK, you will need to convert the PKCS1 file format to PKCS8 file format.\nExport the end-entity's private key to a PKCS8 file:"),(0,n.kt)("pre",null,(0,n.kt)("code",{parentName:"pre",className:"language-command"},"openssl pkcs8 -topk8 -inform PEM -outform PEM -in <out/your-namespace.key> -out <out/your-namespace.pkcs8.key> -nocrypt\n")),(0,n.kt)("p",null,(0,n.kt)("strong",{parentName:"p"},"Use the Certificates with Temporal Cloud")),(0,n.kt)("p",null,"You can now use the generated client certificate (",(0,n.kt)("inlineCode",{parentName:"p"},"your-namespace.crt"),") and the CA certificate (",(0,n.kt)("inlineCode",{parentName:"p"},"Cert.crt"),") with Temporal Cloud.\nYou will upload the contents of the ",(0,n.kt)("inlineCode",{parentName:"p"},"Cert.crt")," file to the ",(0,n.kt)("strong",{parentName:"p"},"CA Certificates")," section of your ",(0,n.kt)("strong",{parentName:"p"},"Namespace")," settings."),(0,n.kt)("ol",null,(0,n.kt)("li",{parentName:"ol"},"Sign in to your ",(0,n.kt)("a",{parentName:"li",href:"https://cloud.temporal.io/"},"Cloud account"),"."),(0,n.kt)("li",{parentName:"ol"},"On the left-hand navigation menu, select ",(0,n.kt)("strong",{parentName:"li"},"Namespaces"),"."),(0,n.kt)("li",{parentName:"ol"},"Select your Namespace and then choose ",(0,n.kt)("strong",{parentName:"li"},"Edit"),"."),(0,n.kt)("li",{parentName:"ol"},"Paste your CA Certificate into the ",(0,n.kt)("strong",{parentName:"li"},"CA Certificates")," section."),(0,n.kt)("li",{parentName:"ol"},"Select ",(0,n.kt)("strong",{parentName:"li"},"Save")," to continue.")),(0,n.kt)("admonition",{type:"note"},(0,n.kt)("p",{parentName:"admonition"},"Make note of the Namespace you uploaded your CA certificate to.\nYou will need it when connecting your Worker to your Namespace and when starting your Workflow.")),(0,n.kt)("p",null,"Now that you have generated your CA certificate and uploaded to your Temporal Namespace, you can update your Worker code."),(0,n.kt)("h2",{id:"update-worker-code-to-connect-to-temporal-cloud"},"Update Worker code to connect to Temporal Cloud"),(0,n.kt)("p",null,"You will build off the code used in the ",(0,n.kt)("a",{parentName:"p",href:"/getting_started/java/first_program_in_java/"},"Run your first Temporal application with the Java SDK")," tutorial."),(0,n.kt)("p",null,"When working with Temporal Cloud, you will provide an encrypted connection using Mutual Transport Layer Security (mTLS) to secure the communication between your application and the Temporal Cloud service."),(0,n.kt)("p",null,"Open the ",(0,n.kt)("inlineCode",{parentName:"p"},"MoneyTransferWorker.java")," file and update your code."),(0,n.kt)("p",null,"This is used to configure settings used when connecting to Temporal Cloud."),(0,n.kt)("p",null,(0,n.kt)("a",{parentName:"p",href:"https://github.com/temporalio/money-transfer-project-java/blob/cloud/src/main/java/moneytransferapp/MoneyTransferWorker.java"},"src/main/java/moneytransferapp/MoneyTransferWorker.java")),(0,n.kt)("pre",null,(0,n.kt)("code",{parentName:"pre",className:"language-java"},"import java.lang.System;\nimport java.io.FileInputStream;\nimport java.io.InputStream;\nimport io.grpc.netty.shaded.io.netty.handler.ssl.SslContext;\nimport io.temporal.client.WorkflowClient;\nimport io.temporal.client.WorkflowClientOptions;\nimport io.temporal.serviceclient.SimpleSslContextBuilder;\nimport io.temporal.serviceclient.WorkflowServiceStubs;\nimport io.temporal.serviceclient.WorkflowServiceStubsOptions;\nimport io.temporal.worker.Worker;\nimport io.temporal.worker.WorkerFactory;\nimport java.io.IOException;\n")),(0,n.kt)("p",null,"Temporal supports mTLS as a way of encrypting network traffic between the services of a cluster and also between application processes and a Cluster.\nFor more information, see ",(0,n.kt)("a",{parentName:"p",href:"https://docs.temporal.io/cloud/security"},"Security model")," in Temporal Cloud."),(0,n.kt)("p",null,"To read the TLS certificate and key files, use the ",(0,n.kt)("inlineCode",{parentName:"p"},"System.getenv()"),".\nAdd the following code to your ",(0,n.kt)("inlineCode",{parentName:"p"},"main")," method:"),(0,n.kt)("p",null,(0,n.kt)("a",{parentName:"p",href:"https://github.com/temporalio/money-transfer-project-java/blob/cloud/src/main/java/moneytransferapp/MoneyTransferWorker.java"},"src/main/java/moneytransferapp/MoneyTransferWorker.java")),(0,n.kt)("pre",null,(0,n.kt)("code",{parentName:"pre",className:"language-java"},'        // Get the key and certificate from your environment or local machine\n        String clientCertFile = System.getenv("TEMPORAL_MTLS_TLS_CERT");\n        String clientCertPrivateKey = System.getenv("TEMPORAL_MTLS_TLS_KEY");\n\n        // Open the key and certificate as Input Streams\n        InputStream clientCertInputStream = new FileInputStream(clientCertFile);\n        InputStream clientKeyInputStream = new FileInputStream(clientCertPrivateKey);\n\n        // Generate the sslContext using the Client Cert and Key\n        SslContext sslContext = SimpleSslContextBuilder.forPKCS8(clientCertInputStream, clientKeyInputStream).build();\n')),(0,n.kt)("p",null,"This reads the TLS certificate and key file paths from the environment variables and loads the TLS certificate and key pair."),(0,n.kt)("p",null,"Next, specify the host and port of your Temporal Cloud Namespace:"),(0,n.kt)("p",null,(0,n.kt)("a",{parentName:"p",href:"https://github.com/temporalio/money-transfer-project-java/blob/cloud/src/main/java/moneytransferapp/MoneyTransferWorker.java"},"src/main/java/moneytransferapp/MoneyTransferWorker.java")),(0,n.kt)("pre",null,(0,n.kt)("code",{parentName:"pre",className:"language-java"},'        // Specify the host and port of your Temporal Cloud Namespace\n        // Host and port format: namespace.unique_id.tmprl.cloud:port\n        String namespace = System.getenv("TEMPORAL_NAMESPACE");\n        String hostPort = System.getenv("TEMPORAL_HOST_URL");\n\n        // Specify the IP address, port, and SSL Context for the Service Stubs options\n        WorkflowServiceStubsOptions stubsOptions = WorkflowServiceStubsOptions.newBuilder()\n                .setSslContext(sslContext)\n                .setTarget(hostPort)\n                .build();\n')),(0,n.kt)("p",null,"This code reads the Namespace and host URL from environment variables."),(0,n.kt)("p",null,"Next, specify your Workflow Client Options."),(0,n.kt)("p",null,(0,n.kt)("a",{parentName:"p",href:"https://github.com/temporalio/money-transfer-project-java/blob/cloud/src/main/java/moneytransferapp/MoneyTransferWorker.java"},"src/main/java/moneytransferapp/MoneyTransferWorker.java")),(0,n.kt)("pre",null,(0,n.kt)("code",{parentName:"pre",className:"language-java"},"        // Specify the namespace in the Client options\n        WorkflowClientOptions options = WorkflowClientOptions.newBuilder()\n                .setNamespace(namespace)\n                .build();\n\n        WorkflowClient client = WorkflowClient.newInstance(service, options);\n")),(0,n.kt)("p",null,"Next, you will set the required environment variables."),(0,n.kt)("h2",{id:"set-the-required-environment-variables"},"Set the required environment variables"),(0,n.kt)("p",null,"Before running your application, set the following environment variables with the appropriate values provided by your managed Temporal Cloud environment:"),(0,n.kt)("ul",null,(0,n.kt)("li",{parentName:"ul"},(0,n.kt)("inlineCode",{parentName:"li"},"TEMPORAL_MTLS_TLS_CERT"),": The path to the ",(0,n.kt)("inlineCode",{parentName:"li"},".pem")," file with your mTLS x509 Certificate."),(0,n.kt)("li",{parentName:"ul"},(0,n.kt)("inlineCode",{parentName:"li"},"TEMPORAL_MTLS_TLS_KEY"),": The path to the file with your mTLS private key."),(0,n.kt)("li",{parentName:"ul"},(0,n.kt)("inlineCode",{parentName:"li"},"TEMPORAL_HOST_URL"),": The host URL of your managed Temporal Cloud environment."),(0,n.kt)("li",{parentName:"ul"},(0,n.kt)("inlineCode",{parentName:"li"},"TEMPORAL_NAMESPACE"),": The Namespace Name and Account Id associated with your Temporal Cloud environment.")),(0,n.kt)(o.Z,{mdxType:"Tabs"},(0,n.kt)(l.Z,{value:"macos",label:"MacOS",mdxType:"TabItem"},(0,n.kt)("pre",null,(0,n.kt)("code",{parentName:"pre",className:"language-bash"},"export TEMPORAL_MTLS_TLS_CERT=/path/to/tls/cert.pem\nexport TEMPORAL_MTLS_TLS_KEY=/path/to/tls/key.pem\nexport TEMPORAL_HOST_URL=https://namespace.account-id.tmprl.cloud:port\nexport TEMPORAL_NAMESPACE=namespace.account-id\n"))),(0,n.kt)(l.Z,{value:"windows",label:"Windows",mdxType:"TabItem"},(0,n.kt)("pre",null,(0,n.kt)("code",{parentName:"pre",className:"language-bash"},"set TEMPORAL_MTLS_TLS_CERT=C:\\path\\to\\tls\\cert.pem\nset TEMPORAL_MTLS_TLS_KEY=C:\\path\\to\\tls\\key.pem\nset TEMPORAL_HOST_URL=https://namespace.account-id.tmprl.cloud:port\nset TEMPORAL_NAMESPACE=namespace.account-id\n")))),(0,n.kt)("p",null,"Replace ",(0,n.kt)("inlineCode",{parentName:"p"},"namespace"),", ",(0,n.kt)("inlineCode",{parentName:"p"},"account-id"),", and ",(0,n.kt)("inlineCode",{parentName:"p"},"port")," (the default port is ",(0,n.kt)("inlineCode",{parentName:"p"},"7233"),") with the appropriate values for your Temporal Cloud environment."),(0,n.kt)("p",null,(0,n.kt)("strong",{parentName:"p"},"What is a Temporal Namespace?")),(0,n.kt)("p",null,"The ",(0,n.kt)("inlineCode",{parentName:"p"},"TEMPORAL_NAMESPACE")," is the ",(0,n.kt)("strong",{parentName:"p"},"Cloud Namespace Name Id")," and is constructed by concatenating your specified ",(0,n.kt)("strong",{parentName:"p"},"Namespace name"),", a dot (.), and your ",(0,n.kt)("strong",{parentName:"p"},"Account Id"),"."),(0,n.kt)("p",null,"This format, ",(0,n.kt)("strong",{parentName:"p"},"Namespace name.Account Id"),", serves as a globally unique identifier for a Namespace within the Temporal Cloud service."),(0,n.kt)("p",null,"The ",(0,n.kt)("strong",{parentName:"p"},"Namespace name")," (user-defined) on the left, combined with the ",(0,n.kt)("strong",{parentName:"p"},"Account Id")," (system-assigned) on the right, forms the complete ",(0,n.kt)("strong",{parentName:"p"},"Cloud Namespace ID"),"."),(0,n.kt)("p",null,"The following is an example of a Cloud Namespace Name Id, where ",(0,n.kt)("inlineCode",{parentName:"p"},"docs-assembly")," is the Namespace name and ",(0,n.kt)("inlineCode",{parentName:"p"},"a2dd6")," is the Account Id."),(0,n.kt)("p",null,(0,n.kt)("img",{alt:"Cloud Namespace Name Id",src:a(9647).Z,width:"1070",height:"252"})),(0,n.kt)("p",null,"The Cloud Namespace Name Id is crucial for deriving the gRPC endpoint needed when configuring a Client to access Temporal Cloud."),(0,n.kt)("h2",{id:"run-your-application-connected-to-temporal-cloud"},"Run your application connected to Temporal Cloud"),(0,n.kt)("p",null,"After completing these steps, your application is ready to connect to Temporal Cloud."),(0,n.kt)("ol",null,(0,n.kt)("li",{parentName:"ol"},"Run the ",(0,n.kt)("inlineCode",{parentName:"li"},"temporal workflow start")," command.")),(0,n.kt)("pre",null,(0,n.kt)("code",{parentName:"pre",className:"language-command"},"temporal workflow start \\\n --task-queue money-transfer \\\n --type MoneyTransfer \\\n --tls-cert-path ${TEMPORAL_MTLS_TLS_CERT} \\\n --tls-key-path ${TEMPORAL_MTLS_TLS_KEY} \\\n --namespace ${TEMPORAL_NAMESPACE} \\\n --address ${TEMPORAL_HOST_URL}\n")),(0,n.kt)("p",null,"Ensure that the certificate path, private key path, Namespace, and address argument values match your project."),(0,n.kt)("ol",{start:2},(0,n.kt)("li",{parentName:"ol"},"Sign in to your ",(0,n.kt)("a",{parentName:"li",href:"http://cloud.temporal.io"},"Cloud account"),"."),(0,n.kt)("li",{parentName:"ol"},"Visit the Workflow page of your Cloud Namespace.\nThe URL will look something like the following:")),(0,n.kt)("pre",null,(0,n.kt)("code",{parentName:"pre",className:"language-text"},"https://cloud.temporal.io/namespaces/<namespace>.<account-id>/workflows\n")),(0,n.kt)("p",null,"You will see the last run of your Workflow matches the command you ran."),(0,n.kt)("h2",{id:"conclusion"},"Conclusion"),(0,n.kt)("p",null,"Migrating your application from a local Temporal Server to a managed Temporal Cloud environment requires setting up your certificates, creating a connection, and running your code."),(0,n.kt)("p",null,"By leveraging Temporal Cloud, you can focus on developing and deploying your application without the overhead of managing the underlying infrastructure.\nTemporal Cloud provides a scalable and reliable platform for running your Workflows and Activities, ensuring the durability and resilience of your application."),(0,n.kt)("p",null,"By running your application in Temporal Cloud, you can benefit from a robust and efficient environment that supports the execution of your distributed applications and services."))}d.isMDXComponent=!0},9647:(e,t,a)=>{a.d(t,{Z:()=>r});const r=a.p+"assets/images/namespace-id-9cb49ba322d630dd4c787969b1f554f8.png"}}]);